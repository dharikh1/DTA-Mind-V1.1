# DTA Mind - Development Environment
# Development Dockerfile with hot reloading

FROM node:20-alpine

# Install development dependencies
RUN apk add --no-cache git

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./
COPY pnpm-workspace.yaml ./
COPY packages/components/package.json ./packages/components/
COPY packages/ui/package.json ./packages/ui/
COPY packages/server/package.json ./packages/server/
COPY packages/api-documentation/package.json ./packages/api-documentation/

# Install pnpm globally
RUN npm install -g pnpm

# Install dependencies
RUN pnpm install

# Copy source code
COPY . .

# Install ts-node for direct TypeScript execution
RUN pnpm add -D ts-node typescript @types/node

# Install dependencies only (no build step)
RUN echo "Dependencies installed successfully"

# Set environment variables
ENV NODE_ENV=development
ENV PORT=3000
ENV UI_PORT=8080

# Expose ports
EXPOSE 3000 8080

# Start development environment
CMD ["sh", "-c", "echo 'ðŸš€ Starting DTA Mind Development Environment...' && echo 'ðŸ“¦ Backend: http://localhost:3000' && echo 'ðŸŽ¨ Frontend: http://localhost:8080' && echo 'ðŸ”„ Hot reloading enabled' && exec pnpm dev:full"]
